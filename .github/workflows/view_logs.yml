name: Deploy

on:
  push:

jobs:
  evaluate:
    runs-on: ubuntu-latest
    outputs:
      proceed: ${{ steps.set-result.outputs.proceed }}
    steps:
      - name: Evaluate logic
        id: set-result
        run: |
          # Set the output value
          echo "proceed=true" >> $GITHUB_OUTPUT  # 👈 Only this line is needed now

  approve:
    needs: evaluate
    if: needs.evaluate.outputs.proceed == 'false'
    runs-on: ubuntu-latest
    environment:
      name: manual-approval
      url: https://github.com
    steps:
      - name: Wait for manual approval
        run: echo "⏳ Waiting for manual approval..."

  deploy:
    needs: [evaluate, approve]
    if: needs.evaluate.outputs.proceed == 'true' || needs.approve.result == 'success'
    runs-on: ubuntu-latest
    steps:
      - name: Deploying...
        run: echo "🚀 Deploying View Logs Action!"
